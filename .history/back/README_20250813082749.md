# API MicroMídia

API REST para fórum de microempreendedores com sistema de postagens, comentários e curtidas.

## Configuração

1. **Instalar dependências:**
   ```bash
   npm install
   ```

2. **Configurar banco de dados:**
   - Crie um banco MySQL/MariaDB
   - Execute o script SQL em `../front/SQL/micro_midia.sql`
   - Configure as credenciais no arquivo `.env`

3. **Configurar variáveis de ambiente:**
   Edite o arquivo `.env` com suas configurações:
   ```
   DB_HOST=localhost
   DB_USER=root
   DB_PASSWORD=sua_senha
   DB_NAME=micro_midia
   JWT_SECRET=sua_chave_secreta_jwt
   PORT=3000
   ```

4. **Executar a aplicação:**
   ```bash
   # Desenvolvimento (com auto-reload)
   npm run dev

   # Produção
   npm start
   ```

## Endpoints da API

### Autenticação

#### POST `/api/auth/register`
Registra um novo usuário.
```json
{
  "nome": "Nome do Usuário",
  "email": "email@example.com",
  "senha": "senha123",
  "bio": "Biografia opcional"
}
```

#### POST `/api/auth/login`
Realiza login do usuário.
```json
{
  "email": "email@example.com",
  "senha": "senha123"
}
```

### Usuários

#### GET `/api/users/profile`
Obtém perfil do usuário logado. (Requer autenticação)

#### PUT `/api/users/profile`
Atualiza perfil do usuário logado. (Requer autenticação)
```json
{
  "nome": "Novo Nome",
  "bio": "Nova biografia"
}
```

#### GET `/api/users`
Lista todos os usuários.

### Postagens

#### GET `/api/posts`
Lista todas as postagens.

#### GET `/api/posts/:id`
Obtém uma postagem específica.

#### POST `/api/posts`
Cria nova postagem. (Requer autenticação)
```json
{
  "conteudo": "Conteúdo da postagem",
  "imagem": "URL da imagem (opcional)"
}
```

#### PUT `/api/posts/:id`
Atualiza postagem. (Requer autenticação e ser o autor)
```json
{
  "conteudo": "Novo conteúdo",
  "imagem": "Nova URL da imagem (opcional)"
}
```

#### DELETE `/api/posts/:id`
Deleta postagem. (Requer autenticação e ser o autor)

### Comentários

#### GET `/api/comments/post/:postId`
Lista comentários de uma postagem.

#### POST `/api/comments`
Cria novo comentário. (Requer autenticação)
```json
{
  "postagem_id": 1,
  "texto": "Texto do comentário"
}
```

#### PUT `/api/comments/:id`
Atualiza comentário. (Requer autenticação e ser o autor)
```json
{
  "texto": "Novo texto do comentário"
}
```

#### DELETE `/api/comments/:id`
Deleta comentário. (Requer autenticação e ser o autor)

### Curtidas

#### POST `/api/likes/toggle`
Curte/descurte uma postagem. (Requer autenticação)
```json
{
  "postagem_id": 1
}
```

#### GET `/api/likes/check/:postId`
Verifica se o usuário curtiu uma postagem. (Requer autenticação)

#### GET `/api/likes/count/:postId`
Obtém número total de curtidas de uma postagem.

## Autenticação

A API usa JWT (JSON Web Tokens) para autenticação. Para endpoints que requerem autenticação, inclua o token no header:

```
Authorization: Bearer <seu_token_jwt>
```

## Estrutura do Projeto

```
back/
├── config/
│   └── database.js         # Configuração do banco de dados
├── middleware/
│   └── auth.js            # Middleware de autenticação
├── routes/
│   ├── auth.js            # Rotas de autenticação
│   ├── users.js           # Rotas de usuários
│   ├── posts.js           # Rotas de postagens
│   ├── comments.js        # Rotas de comentários
│   └── likes.js           # Rotas de curtidas
├── uploads/               # Diretório para upload de arquivos
├── .env                   # Variáveis de ambiente
├── server.js             # Arquivo principal do servidor
└── package.json          # Dependências e scripts
```

## Próximos Passos

- [ ] Upload de imagens
- [ ] Sistema de notificações
- [ ] Categorias de postagens
- [ ] Sistema de busca
- [ ] Paginação
- [ ] Rate limiting
- [ ] Logs de auditoria
